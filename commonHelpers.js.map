{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["const APIKey = \"44834659-67420821c74452072565be409\";\n\nexport const fetchImages = async (query) => {\n    try {    \n        const encodedQuery = encodeURIComponent(query);\n        const response = await axios.get(`https://pixabay.com/api/?key=${APIKey}&q=${encodedQuery}&image_type=photo&orientation=horizontal&safesearch=true&per_page=15&page=1`);\n        return response;\n    }\n    catch (error) {    \n        return new Error(error.message);\n    }     \n};\n\nexport const loadMoreImages = async (query, pageCount) => {\n    try {\n        const encodedQuery = encodeURIComponent(query);\n        const response = await axios.get(`https://pixabay.com/api/?key=${APIKey}&q=${encodedQuery}&image_type=photo&orientation=horizontal&safesearch=true&per_page=15&page=${pageCount}`);\n        if (response.data.hits.length === 0) return new Error();\n        return response;\n    }\n    catch (error) {\n        return new Error();\n    }\n}","export const renderGallery = async (images, galleryElement) => {\n    const galleryItems = images.map(image =>\n        `<li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n                <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\"/>\n            </a>\n            <ul class=\"info-summary\">\n                <li class=\"info-item\"><h3 class=\"info-title\">Likes</h3><p class=\"info-statistics\">${image.likes}</p></li>\n                <li class=\"info-item\"><h3 class=\"info-title\">Views</h3><p class=\"info-statistics\">${image.views}</p></li>\n                <li class=\"info-item\"><h3 class=\"info-title\">Comments</h3><p class=\"info-statistics\">${image.comments}</p></li>\n                <li class=\"info-item\"><h3 class=\"info-title\">Downloads</h3><p class=\"info-statistics\">${image.downloads}</p></li>\n            </ul>\n        </li>`\n    ).join('');\n    galleryElement.insertAdjacentHTML(\"beforeend\", galleryItems);\n};\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { fetchImages, loadMoreImages } from './js/pixabay-api.js';\nimport { renderGallery } from './js/render-function.js';\n\nconst form = document.querySelector(\".form\");\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loadMoreBtn = document.querySelector(\".load-more-btn\");\nconst smplGallery = new SimpleLightbox('.gallery-item a', { captions: true, captionsData: 'alt', captionDelay: 250 });\nlet query = \"\";\nlet pageCount = 1;\nconst imagesPerPage = 15;  \n\nconst clearSearchValue = (evt) => {\n  evt.target.elements.search.value = \"\";\n};\n\nconst clearGallery = (gallery) => {\n    gallery.innerHTML = \"\";\n}\n\nconst showLoader = (position) => {\n    if (position === 'aboveGallery') {\n        gallery.parentNode.insertBefore(loader, gallery);\n    } else if (position === 'aboveLoadMore') {\n        loadMoreBtn.parentNode.insertBefore(loader, loadMoreBtn);\n    }\n    loader.style.display = \"block\";\n};\n\nform.addEventListener(\"submit\", async (evt) => {\n    evt.preventDefault();\n    showLoader('aboveGallery');\n    loadMoreBtn.style.display = \"block\";\n    query = evt.target.elements.search.value.trim();\n    pageCount = 1;  \n    if (query.length <= 0) {\n        loader.style.display = \"none\";\n        clearGallery(gallery);\n        clearSearchValue(evt);\n        loadMoreBtn.style.display = \"none\";\n        return iziToast.error({ title: \"Error\", message: \"Search value is empty\", position: \"topRight\" });\n    }\n\n    try {\n        const response = await fetchImages(query);\n        loader.style.display = \"none\";\n        if (response.data.totalHits === 0) {\n            evt.target.elements.search.value = \"\";\n            throw new Error(\"No images found\");\n        }\n        clearGallery(gallery);\n        await renderGallery(response.data.hits, gallery);\n        clearSearchValue(evt);\n        smplGallery.refresh();\n\n        if (response.data.totalHits <= imagesPerPage) {\n            loadMoreBtn.style.display = \"none\";\n            iziToast.info({\n                title: \"Info\",\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: \"topRight\"\n            });\n        }\n    } catch (error) {\n        loadMoreBtn.style.display = \"none\";\n        loader.style.display = \"none\";\n        iziToast.error({ \n            title: \"Error\", \n            message: `Sorry, there are no images matching your search query. Please try again! Error: ${error.message}`, \n            position: \"topRight\" \n        });\n        clearSearchValue(evt);\n        clearGallery(gallery);\n    }\n});\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n    pageCount += 1;    \n    showLoader('aboveLoadMore');\n\n    try {\n        const response = await loadMoreImages(query, pageCount);\n        loader.style.display = \"none\";\n        let responseHits = response.data.hits.length;\n\n        if (responseHits > 0) {\n            await renderGallery(response.data.hits, gallery);\n            const xScrollValue = document.querySelector(\".gallery-item\").getBoundingClientRect().height * 2;\n            window.scrollBy({\n                top: xScrollValue,\n                behavior: 'smooth',\n            });\n            smplGallery.refresh();\n        }\n\n        if (responseHits < imagesPerPage) {\n            loadMoreBtn.style.display = \"none\";\n            iziToast.info({ \n                title: \"Info\", \n                message: \"We're sorry, but you've reached the end of search results.\", \n                position: \"topRight\" \n            });\n        }\n\n    } catch (error) {\n        loadMoreBtn.style.display = \"none\";\n        loader.style.display = \"none\";\n        iziToast.info({ \n            title: \"Info\", \n            message: \"We're sorry, but you've reached the end of search results.\", \n            position: \"topRight\" \n        });\n    }\n});\n"],"names":["APIKey","fetchImages","query","encodedQuery","error","loadMoreImages","pageCount","response","renderGallery","images","galleryElement","galleryItems","image","form","gallery","loader","loadMoreBtn","smplGallery","SimpleLightbox","imagesPerPage","clearSearchValue","evt","clearGallery","showLoader","position","iziToast","responseHits","xScrollValue"],"mappings":"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"}